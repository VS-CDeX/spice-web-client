function dispatch(t,e){var i=new Uint8Array(t),r=i[3],o=null,_=i[0];if(_===wdi.WorkerOperations.quic)try{o=wdi.JSQuic.quic_decode(t)}catch(t){}else if(_===wdi.WorkerOperations.lz_rgb)try{o=wdi.LZSS.lz_rgb32_decompress_rgb(t)}catch(t){}else if(_===wdi.WorkerOperations.bytesToUriJpeg)try{return o=bytesToURI(i,"jpeg"),void self.postMessage(o)}catch(t){}else if(_===wdi.WorkerOperations.bytesToUriPng)try{return o=bytesToURI(i,"png"),void self.postMessage(o)}catch(t){}if(!e||!o)return o;r?self.postMessage(o,[o]):self.postMessage(o)}function bytesToURI(t,e){for(var i="data:image/"+e+",",r=t.length,o=4;o<r;o++)t[o]<16?i+="%0":i+="%",i+=t[o].toString(16);return i}function bytesToInt16(t){var e=t.shift();return t.shift()*Math.pow(16,2)+e}function bytesToInt32(t){var e=bytesToInt16(t);return bytesToInt16(t)*Math.pow(16,4)+e}function wdi_quic_QuicFamily(){this.notGRcwlen=[],this.nGRcodewords=[],this.notGRprefixmask=[],this.notGRsuffixlen=[],this.xlatU2L=[],this.xlatL2U=[]}function wdi_quic_s_bucket(){this.pcounters=null,this.bestcode=0}function wdi_quic_CommonState(){(this.wm_trigger=this).encoder=null,this.waitcnt=0,this.tabrand_seed=wdi.JSQuic.stabrand(),this.wmidx=wdi.JSQuic.DEFwmistart,this.wmileft=wdi.JSQuic.wminext,wdi.JSQuic.set_wm_trigger(this),this.melcstate=0,this.melclen=wdi.JSQuic.J[0],this.melcorder=1<<this.melclen>>>0}function wdi_quic_FamilyStat(){this.buckets_buf=null,this.buckets_ptrs=null,this.counters=0}function wdi_quic_Channel(){this.encoder=null,this.correlate_row_width=0,this.correlate_row=null,this._buckets_ptrs=null,this.family_stat_8bpc=new wdi_quic_FamilyStat,this.family_stat_5bpc=new wdi_quic_FamilyStat,this.state=new wdi_quic_CommonState,this.oldFirst=0}function wdi_quic_Encoder(t){this.computedWidth=0,this.result=[],this.cnt=0,this.pxCnt=0,this.usr=t,this.type=null,this.width=null,this.height=null,this.num_channels=null,this.n_buckets_8bpc=null,this.n_buckets_5bpc=null,this.io_available_bits=32,this.io_now=0,this.io_next_word=null,this.io_now=null,this.read_io_word(),this.io_word=this.io_next_word,this.read_io_word(),this.io_words_count=t.length,this.rows_completed=0,this.channels=[],this.alphaPos=3,this.rgb_state=new wdi_quic_CommonState;for(var e=0;e<4;e++)this.channels[e]=new wdi_quic_Channel,wdi.JSQuic.initChannel(this,this.channels[e])}function cnt_l_zeroes(t){return 8388607<t?wdi.JSQuic.lzeroes[t>>>24]:32767<t?8+wdi.JSQuic.lzeroes[t>>>16&255]:127<t?16+wdi.JSQuic.lzeroes[t>>>8&255]:24+wdi.JSQuic.lzeroes[255&t]}function golomb_code_len(t,e){return t<wdi.nGRcodewords[e]?1+(t>>>e)+e:wdi.notGRcwlen[e]}function golomb_decoding(t,e,i,r,o,_,n){var s,a;if(e>r[t]){var c=cnt_l_zeroes(e);a=c<<t|e>>>32-(s=c+1+t)&i[t]}else s=o[t],a=_[t]+(e>>>32-s&i[n[t]]);return[a,s]}function real_update_model(t,e,i,r,o){var _,n,s,a,c=e.pcounters;for(s=c[n=r-1]+=golomb_code_len(i,n),_=r-2;0<=_;_--)(a=c[_]+=golomb_code_len(i,_))<s&&(n=_,s=a);if(e.bestcode=n,s>t.wm_trigger)for(;0<r--;)c[r]>>>=1}function UPDATE_MODEL(t,e,i,r,o,_){real_update_model(e.rgb_state,find_bucket(e.channels[0],r[t-1]),r[t],i),real_update_model(e.rgb_state,find_bucket(e.channels[1],o[t-1]),o[t],i),real_update_model(e.rgb_state,find_bucket(e.channels[2],_[t-1]),_[t],i)}function find_bucket(t,e){return void 0===e&&(e=t.oldFirst),t._buckets_ptrs[e]}function QUIC_UNCOMPRESS_RGBA(t,e,i,r){quic_uncompress_row0(t,e,i,r),quic_four_uncompress_row0(t,t.channels[3],i,r),t.row_completed();for(var o=t.height,_=t.rgb_state,n=1;n<o;n++)quic_uncompress_row_a(t,e,i,r,_),quic_four_uncompress_row(t,t.channels[3],i,r),t.row_completed()}function quic_four_uncompress_row(t,e,i,r){for(var o=wdi.JSQuic.BPC_MASK[r],_=0,n=t.width;wdi.JSQuic.wmimax>e.state.wmidx&&e.state.wmileft<=n;)e.state.wmileft&&(uncompress_four_row_seg(t,e,_,_+e.state.wmileft,i,o,r),_+=e.state.wmileft,n-=e.state.wmileft),e.state.wmidx++,wdi.JSQuic.set_wm_trigger(e.state),e.state.wmileft=wdi.JSQuic.wminext;n&&(uncompress_four_row_seg(t,e,_,_+n,i,o,r),wdi.JSQuic.wmimax>e.state.wmidx&&(e.state.wmileft-=n))}function uncompress_four_row_seg(t,e,i,r,o,_,n){var s,a,c,d,w=e.correlate_row,l=0,u=wdi.JSQuic.bppmask[e.state.wmidx],f=0,m=0,b=!1,p=t.computedWidth,h=t.rows_completed,E=(t.rows_completed-1)*p,S=t.eatbits,R=t.appendAlpha,A=wdi.JSQuic.bppmask,g=wdi.notGRprefixmask,x=wdi.notGRcwlen,G=wdi.nGRcodewords,Q=wdi.notGRsuffixlen;for(i?(l=i+e.state.waitcnt,a=t.result[t.alphaPos-4]):(a=UNCOMPRESS_ONE_0_A(e,t,_,E),e.state.waitcnt?--e.state.waitcnt:(e.state.waitcnt=wdi.JSQuic.tabrand(e.state)&u,real_update_model(e.state,find_bucket(e,w[-1]),w[0],o)),l=++i+e.state.waitcnt);;){for(;l<r;){for(;i<=l&&!(b=RLE_PRED_A(i,t,f,p,h));i++)s=(c=golomb_decoding(find_bucket(e,w[i-1]).bestcode,t.io_word,A,g,x,G,Q))[0],d=c[1],w[i]=s,a=(wdi.xlatL2U[s]+(a+PIXEL_B(e,t,i,E)>>>1)&_)>>>0,R.call(t,a),S(d,t);if(b)break;real_update_model(e.state,find_bucket(e,w[l-1]),w[l],o),l=i+(wdi.JSQuic.tabrand(e.state)&u)}if(!b){for(;i<r&&!(b=RLE_PRED_A(i,t,f,p,h));i++)s=(c=golomb_decoding(find_bucket(e,w[i-1]).bestcode,t.io_word,A,g,x,G,Q))[0],d=c[1],w[i]=s,a=(wdi.xlatL2U[s]+(a+PIXEL_B(e,t,i,E)>>>1)&_)>>>0,R.call(t,a),S(d,t);if(!b)return void(e.state.waitcnt=l-r)}e.state.waitcnt=l-i,m=(f=i)+wdi.JSQuic.decode_channel_run(t,e);for(var v=t.rows_completed*(4*t.width)+4*i,P=t.result[v-1];i<m;i++)R.call(t,P);if(i===r)return;l=i+e.state.waitcnt,b=!1}}function quic_four_uncompress_row0(t,e,i,r){for(var o=wdi.JSQuic.BPC_MASK[r],_=0,n=t.width;wdi.JSQuic.wmimax>e.state.wmidx&&e.state.wmileft<=n;)e.state.wmileft&&(uncompress_four_row0_seg(t,e,_,_+e.wmileft,wdi.JSQuic.bppmask[e.state.wmidx],i,o,r),_+=e.state.wmileft,n-=e.state.wmileft),e.state.wmidx++,wdi.JSQuic.set_wm_trigger(e.state),e.state.wmileft=wdi.JSQuic.wminext;n&&(uncompress_four_row0_seg(t,e,_,_+n,wdi.JSQuic.bppmask[e.state.wmidx],i,o,r),wdi.JSQuic.wmimax>e.state.wmidx&&(e.state.wmileft-=n))}function uncompress_four_row0_seg(t,e,i,r,o,_,n,s){var a=e.correlate_row,c=0;for(c=i?i+e.state.waitcnt:(UNCOMPRESS_ONE_ROW0_0_A(e),e.state.waitcnt?--e.state.waitcnt:(e.state.waitcnt=wdi.JSQuic.tabrand(e.state)&o,real_update_model(e.state,find_bucket(e,a[-1]),a[0],_)),++i+e.state.waitcnt);c<r;){for(;i<=c;i++)UNCOMPRESS_ONE_ROW0_A(e,i,n,t,a);real_update_model(e.state,find_bucket(e,a[c-1]),a[c],_),c=i+(wdi.JSQuic.tabrand(e.state)&o)}for(;i<r;i++)UNCOMPRESS_ONE_ROW0_A(e,i,n,t,a);e.state.waitcnt=c-r}function SAME_PIXEL_A(t,e){return e[t-1]===e[t+3]}function RLE_PRED_A(t,e,i,r,o){var _=(o-1)*r+4*t;return!!(i!==t&&2<t&&SAME_PIXEL_A(_,e.result)&&SAME_PIXEL_A(_=o*r+4*(t-1),e.result))}function UNCOMPRESS_ONE_0_A(t,e,i,r){var o,_;t.oldFirst=t.correlate_row[0],o=golomb_decoding(find_bucket(t,t.correlate_row[-1]).bestcode,e.io_word,wdi.JSQuic.bppmask,wdi.notGRprefixmask,wdi.notGRcwlen,wdi.nGRcodewords,wdi.notGRsuffixlen),t.correlate_row[0]=o[0],_=o[1];var n=(wdi.xlatL2U[t.correlate_row[0]]+PIXEL_B(t,e,0,r)&i)>>>0;return e.appendAlpha(n),e.eatbits(_,e),n}function UNCOMPRESS_ONE_A(t,e,i,r,o,_){var n,s,a=(n=golomb_decoding(find_bucket(t,o[e-1]).bestcode,r.io_word,wdi.JSQuic.bppmask,wdi.notGRprefixmask,wdi.notGRcwlen,wdi.nGRcodewords,wdi.notGRsuffixlen))[0];s=n[1],o[e]=a,r.appendAlpha((wdi.xlatL2U[a]+(PIXEL_A_A(r)+PIXEL_B(t,r,e,_)>>>1)&i)>>>0),r.eatbits(s,r)}function UNCOMPRESS_ONE_ROW0_0_A(t){var e,i,r=t.encoder;e=golomb_decoding(find_bucket(t,0).bestcode,r.io_word,wdi.JSQuic.bppmask,wdi.notGRprefixmask,wdi.notGRcwlen,wdi.nGRcodewords,wdi.notGRsuffixlen),t.correlate_row[0]=e[0],i=e[1],r.appendAlpha(wdi.xlatL2U[t.correlate_row[0]]),r.eatbits(i,r)}function UNCOMPRESS_ONE_ROW0_A(t,e,i,r,o){var _,n,s=(_=golomb_decoding(find_bucket(t,o[e-1]).bestcode,r.io_word,wdi.JSQuic.bppmask,wdi.notGRprefixmask,wdi.notGRcwlen,wdi.nGRcodewords,wdi.notGRsuffixlen))[0];n=_[1],o[e]=s,r.appendAlpha(CORELATE_0_A(r,t,e,i,o)),r.eatbits(n,r)}function CORELATE_0_A(t,e,i,r,o){return(wdi.xlatL2U[o[i]]+PIXEL_A_A(t)&r)>>>0}function PIXEL_A_A(t){return t.result[t.alphaPos-4]}function QUIC_UNCOMPRESS_RGB(t,e,i,r){quic_uncompress_row0(t,e,i,r),t.row_completed();for(var o=t.rgb_state,_=t.height,n=t.result,s=t.resultData,a=t.width,c=wdi.JSQuic.BPC_MASK[r],d=wdi.JSQuic,w=t.channels[0],l=t.channels[1],u=t.channels[2],f=w._buckets_ptrs,m=l._buckets_ptrs,b=u._buckets_ptrs,p=w.correlate_row,h=l.correlate_row,E=u.correlate_row,S=t.computedWidth,R=wdi.xlatL2U,A=wdi.JSQuic.lzeroes,g=wdi.JSQuic.lzeroes8,x=wdi.JSQuic.lzeroes16,G=wdi.JSQuic.lzeroes24,Q=wdi.notGRprefixmask,v=wdi.notGRcwlen,P=wdi.nGRcodewords,k=wdi.notGRsuffixlen,I=t.eatbits,U=wdi.JSQuic.tabrand,L=wdi.JSQuic.decode_run,M=wdi.JSQuic.bppmask,J=(d=wdi.JSQuic,wdi.JSQuic.tabrand_chaos),y=d.TABRAND_SEEDMASK,O=t.usr,T=1;T<_;T++)quic_uncompress_row(t,e,i,r,o,255<<24,n,s,a,c,d,w,l,u,f,m,b,p,h,E,S,R,A,g,x,G,Q,v,P,k,I,U,L,M,J,y,O),t.rows_completed++}function quic_uncompress_row(t,e,i,r,o,_,n,s,a,c,d,w,l,u,f,m,b,p,h,E,S,R,A,g,x,G,Q,v,P,k,I,U,L,M,J,y,O){for(var T=0,C=t.rows_completed,N=C*S/4,z=(C-1)*S;d.wmimax>o.wmidx&&o.wmileft<=a;)o.wmileft&&(uncompress_row_seg(t,T,T+o.wmileft,i,c,r,o,_,n,s,w,l,u,f,m,b,p,h,E,S,R,A,g,x,G,Q,v,P,k,I,U,L,M,d,J,C,y,z,N,O),T+=o.wmileft,a-=o.wmileft),o.wmidx++,d.set_wm_trigger(o),o.wmileft=d.wminext;a&&(uncompress_row_seg(t,T,T+a,i,c,r,o,_,n,s,w,l,u,f,m,b,p,h,E,S,R,A,g,x,G,Q,v,P,k,I,U,L,M,d,J,C,y,z,N,O),d.wmimax>t.rgb_state.wmidx&&(o.wmileft-=a))}function quic_uncompress_row_a(t,e,i,r,o){for(var _=wdi.JSQuic.BPC_MASK[r],n=0,s=t.width;wdi.JSQuic.wmimax>o.wmidx&&o.wmileft<=s;)o.wmileft&&(uncompress_row_seg_a(t,n,n+o.wmileft,i,_,r,o),n+=o.wmileft,s-=o.wmileft),o.wmidx++,wdi.JSQuic.set_wm_trigger(o),o.wmileft=wdi.JSQuic.wminext;s&&(uncompress_row_seg_a(t,n,n+s,i,_,r,o),wdi.JSQuic.wmimax>t.rgb_state.wmidx&&(o.wmileft-=s))}function SAME_PIXEL_RGB_A(t,e){return e[t-4]===e[t]&&e[t-3]===e[t+1]&&e[t-2]===e[t+2]}function SAME_PIXEL(t,e){return e[t-1]===e[t]}function RLE_PRED_RGB_A(t,e,i,r,o){if(o!==t&&2<t&&(SAME_PIXEL_RGB_A(i,e.result)&&SAME_PIXEL_RGB_A(r+4*(t-1),e.result)))return!0;return!1}function RLE_PRED(t,e,i,r,o){if(o!==t&&2<t&&(SAME_PIXEL(4*i,e.result)&&SAME_PIXEL(4*(r+t-1),e.result)))return!0;return!1}function uncompress_row_seg(t,e,i,r,o,_,n,s,a,c,d,w,l,u,f,m,b,p,h,E,S,R,A,g,x,G,Q,v,P,k,I,U,L,M,J,y,O,T,C,N){var z,D,B,q,Y,W,X,F,Z,K,V,H,j,$,tt,et,it,rt,ot,_t=0,nt=L[n.wmidx],st=0,at=!1,ct=t.cnt,dt=t.pxCnt;for(e?(_t=e+n.waitcnt,B=a[ct-4],q=a[ct-3],Y=a[ct-2],W=b[e-1],X=p[e-1],F=h[e-1]):(B=UNCOMPRESS_ONE_0(d,t,o,T),q=UNCOMPRESS_ONE_0(w,t,o,T),Y=UNCOMPRESS_ONE_0(l,t,o,T),W=b[0],X=p[0],F=h[0],c[dt++]=255<<24|Y<<16|q<<8|B,n.waitcnt?--n.waitcnt:(n.waitcnt=I.call(M,n)&nt,UPDATE_MODEL(0,t,r,b,p,h)),_t=++e+n.waitcnt);;){for(;_t<i;){for(D=T+4*e;e<=_t;e++){if(c[($=D/4)-1]===c[$]&&c[(j=C+e-1)-1]===c[j]&&st!==e&&2<e){at=!0;break}K=u[W].bestcode,W=(V=t.io_word)>G[K]?(H=8388607<V?R[V>>>24]:32767<V?A[V>>>16&255]:127<V?g[V>>>8&255]:x[255&V])<<K|V>>>32-(Z=H+1+K)&L[K]:(Z=Q[K],v[K]+(V>>>32-Z&L[P[K]])),B=S[b[e]=W]+(B+a[D++]>>>1)&o,et=t.io_available_bits,it=t.io_word,it<<=Z,0<=(rt=et-Z)?(it=(it|t.io_next_word>>>rt)>>>0,t.io_available_bits=rt,t.io_word=it):(it=((it|=(ot=t.io_next_word)<<(rt=-rt)>>>0)|(ot=N[t.io_now++])>>>(et=32-rt))>>>0,t.io_available_bits=et,t.io_word=it,t.io_next_word=ot),K=f[X].bestcode,X=(V=t.io_word)>G[K]?(H=8388607<V?R[V>>>24]:32767<V?A[V>>>16&255]:127<V?g[V>>>8&255]:x[255&V])<<K|V>>>32-(Z=H+1+K)&L[K]:(Z=Q[K],v[K]+(V>>>32-Z&L[P[K]])),q=S[p[e]=X]+(q+a[D++]>>>1)&o,et=t.io_available_bits,it=t.io_word,it<<=Z,0<=(rt=et-Z)?(it=(it|t.io_next_word>>>rt)>>>0,t.io_available_bits=rt,t.io_word=it):(it=((it|=(ot=t.io_next_word)<<(rt=-rt)>>>0)|(ot=N[t.io_now++])>>>(et=32-rt))>>>0,t.io_available_bits=et,t.io_word=it,t.io_next_word=ot),K=m[F].bestcode,F=(V=t.io_word)>G[K]?(H=8388607<V?R[V>>>24]:32767<V?A[V>>>16&255]:127<V?g[V>>>8&255]:x[255&V])<<K|V>>>32-(Z=H+1+K)&L[K]:(Z=Q[K],v[K]+(V>>>32-Z&L[P[K]])),Y=S[h[e]=F]+(Y+a[D++]>>>1)&o,et=t.io_available_bits,it=t.io_word,it<<=Z,0<=(rt=et-Z)?(it=(it|t.io_next_word>>>rt)>>>0,t.io_available_bits=rt,t.io_word=it):(it=((it|=(ot=t.io_next_word)<<(rt=-rt)>>>0)|(ot=N[t.io_now++])>>>(et=32-rt))>>>0,t.io_available_bits=et,t.io_word=it,t.io_next_word=ot),c[dt++]=s|Y<<16|q<<8|B,D++}if(at)break;real_update_model(n,u[b[tt=_t-1]],b[_t],r),real_update_model(n,f[p[tt]],p[_t],r),real_update_model(n,m[h[tt]],h[_t],r),n.tabrand_seed++,_t=e+(J[n.tabrand_seed&O]&nt)}if(!at){for(D=T+4*e;e<i;e++){if(c[($=D/4)-1]===c[$]&&c[(j=C+e-1)-1]===c[j]&&st!==e&&2<e){at=!0;break}K=u[W].bestcode,W=(V=t.io_word)>G[K]?(H=8388607<V?R[V>>>24]:32767<V?A[V>>>16&255]:127<V?g[V>>>8&255]:x[255&V])<<K|V>>>32-(Z=H+1+K)&L[K]:(Z=Q[K],v[K]+(V>>>32-Z&L[P[K]])),B=S[b[e]=W]+(B+a[D++]>>>1)&o,et=t.io_available_bits,it=t.io_word,it<<=Z,0<=(rt=et-Z)?(it=(it|t.io_next_word>>>rt)>>>0,t.io_available_bits=rt,t.io_word=it):(it=((it|=(ot=t.io_next_word)<<(rt=-rt)>>>0)|(ot=N[t.io_now++])>>>(et=32-rt))>>>0,t.io_available_bits=et,t.io_word=it,t.io_next_word=ot),K=f[X].bestcode,X=(V=t.io_word)>G[K]?(H=8388607<V?R[V>>>24]:32767<V?A[V>>>16&255]:127<V?g[V>>>8&255]:x[255&V])<<K|V>>>32-(Z=H+1+K)&L[K]:(Z=Q[K],v[K]+(V>>>32-Z&L[P[K]])),q=S[p[e]=X]+(q+a[D++]>>>1)&o,et=t.io_available_bits,it=t.io_word,it<<=Z,0<=(rt=et-Z)?(it=(it|t.io_next_word>>>rt)>>>0,t.io_available_bits=rt,t.io_word=it):(it=((it|=(ot=t.io_next_word)<<(rt=-rt)>>>0)|(ot=N[t.io_now++])>>>(et=32-rt))>>>0,t.io_available_bits=et,t.io_word=it,t.io_next_word=ot),K=m[F].bestcode,F=(V=t.io_word)>G[K]?(H=8388607<V?R[V>>>24]:32767<V?A[V>>>16&255]:127<V?g[V>>>8&255]:x[255&V])<<K|V>>>32-(Z=H+1+K)&L[K]:(Z=Q[K],v[K]+(V>>>32-Z&L[P[K]])),Y=S[h[e]=F]+(Y+a[D++]>>>1)&o,et=t.io_available_bits,it=t.io_word,it<<=Z,0<=(rt=et-Z)?(it=(it|t.io_next_word>>>rt)>>>0,t.io_available_bits=rt,t.io_word=it):(it=((it|=(ot=t.io_next_word)<<(rt=-rt)>>>0)|(ot=N[t.io_now++])>>>(et=32-rt))>>>0,t.io_available_bits=et,t.io_word=it,t.io_next_word=ot),c[dt++]=255<<24|Y<<16|q<<8|B,D++}if(!at)return n.waitcnt=_t-i,t.cnt=4*dt,void(t.pxCnt=dt)}for(n.waitcnt=_t-e,st=e,run_end=U(t),e=run_end+e;0<run_end--;)c[dt++]=s|Y<<16|q<<8|B;if(e===i)return t.cnt=4*dt,void(t.pxCnt=dt);W=b[z=e-1],X=p[z],F=h[z],_t=e+n.waitcnt,at=!1}}function uncompress_row_seg_a(t,e,i,r,o,_,n){var s,a,c,d,w,l,u,f,m,b,p,h,E=t.channels[0],S=t.channels[1],R=t.channels[2],A=E._buckets_ptrs,g=S._buckets_ptrs,x=R._buckets_ptrs,G=E.correlate_row,Q=S.correlate_row,v=R.correlate_row,P=0,k=wdi.JSQuic.bppmask[n.wmidx],I=0,U=0,L=!1,M=t.computedWidth,J=(t.rows_completed-1)*M,y=t.rows_completed*M,O=(t.rows_completed,t.rows_completed,t.result),T=t.resultData,C=wdi.xlatL2U,N=t.eatbits,z=wdi.JSQuic.tabrand,D=wdi.JSQuic.decode_run,B=(wdi.JSQuic.lzeroes,wdi.JSQuic.lzeroes8,wdi.JSQuic.lzeroes16,wdi.JSQuic.lzeroes24,t.cnt),q=t.pxCnt,Y=wdi.JSQuic.bppmask,W=wdi.notGRprefixmask,X=wdi.notGRcwlen,F=wdi.nGRcodewords,Z=wdi.notGRsuffixlen;for(e?(P=e+n.waitcnt,c=O[B-4],d=O[B-3],w=O[B-2],l=G[e-1],u=Q[e-1],f=v[e-1]):(c=UNCOMPRESS_ONE_0(E,t,o,J),d=UNCOMPRESS_ONE_0(S,t,o,J),w=UNCOMPRESS_ONE_0(R,t,o,J),l=G[0],u=Q[0],f=v[0],T[q++]=255<<24|w<<16|d<<8|c,n.waitcnt?--n.waitcnt:(n.waitcnt=z.call(wdi.JSQuic,n)&k,UPDATE_MODEL(0,t,r,G,Q,v)),P=++e+n.waitcnt);;){for(;P<i;){for(a=J+4*e;e<=P&&!(L=RLE_PRED_RGB_A(e,t,a,y,I));e++)b=A[l].bestcode,l=(p=t.io_word)>W[b]?(h=cnt_l_zeroes(p))<<b|p>>>32-(m=h+1+b)&Y[b]:(m=X[b],F[b]+(p>>>32-m&Y[Z[b]])),c=C[G[e]=l]+(c+O[a++]>>>1)&o,N(m,t),b=g[u].bestcode,u=(p=t.io_word)>W[b]?(h=cnt_l_zeroes(p))<<b|p>>>32-(m=h+1+b)&Y[b]:(m=X[b],F[b]+(p>>>32-m&Y[Z[b]])),d=C[Q[e]=u]+(d+O[a++]>>>1)&o,N(m,t),b=x[f].bestcode,f=(p=t.io_word)>W[b]?(h=cnt_l_zeroes(p))<<b|p>>>32-(m=h+1+b)&Y[b]:(m=X[b],F[b]+(p>>>32-m&Y[Z[b]])),w=C[v[e]=f]+(w+O[a++]>>>1)&o,N(m,t),T[q++]=255<<24|w<<16|d<<8|c,a++;if(L)break;UPDATE_MODEL(P,t,r,G,Q,v),P=e+(z.call(wdi.JSQuic,n)&k)}if(!L){for(a=J+4*e;e<i&&!(L=RLE_PRED_RGB_A(e,t,a,y,I));e++)b=A[l].bestcode,l=(p=t.io_word)>W[b]?(h=cnt_l_zeroes(p))<<b|p>>>32-(m=h+1+b)&Y[b]:(m=X[b],F[b]+(p>>>32-m&Y[Z[b]])),c=C[G[e]=l]+(c+O[a++]>>>1)&o,N(m,t),b=g[u].bestcode,u=(p=t.io_word)>W[b]?(h=cnt_l_zeroes(p))<<b|p>>>32-(m=h+1+b)&Y[b]:(m=X[b],F[b]+(p>>>32-m&Y[Z[b]])),d=C[Q[e]=u]+(d+O[a++]>>>1)&o,N(m,t),b=x[f].bestcode,f=(p=t.io_word)>W[b]?(h=cnt_l_zeroes(p))<<b|p>>>32-(m=h+1+b)&Y[b]:(m=X[b],F[b]+(p>>>32-m&Y[Z[b]])),w=C[v[e]=f]+(w+O[a++]>>>1)&o,N(m,t),T[q++]=255<<24|w<<16|d<<8|c,a++;if(!L)return n.waitcnt=P-i,t.cnt=4*q,void(t.pxCnt=q)}for(n.waitcnt=P-e,I=e,e=(U=D(t))+e;0<U--;)T[q++]=255<<24|w<<16|d<<8|c;if(e===i)return t.cnt=4*q,void(t.pxCnt=q);l=G[s=e-1],u=Q[s],f=v[s],P=e+n.waitcnt,L=!1}}function quic_uncompress_row0(t,e,i,r){for(var o=wdi.JSQuic.BPC_MASK[r],_=0,n=t.width;wdi.JSQuic.wmimax>t.rgb_state.wmidx&&t.rgb_state.wmileft<=n;)t.rgb_state.wmileft&&(uncompress_row0_seg(t,_,_+t.rgb_state.wmileft,wdi.JSQuic.bppmask[t.rgb_state.wmidx],i,o,r),_+=t.rgb_state.wmileft,n-=t.rgb_state.wmileft),t.rgb_state.wmidx++,wdi.JSQuic.set_wm_trigger(t.rgb_state),t.rgb_state.wmileft=wdi.JSQuic.wminext;n&&(uncompress_row0_seg(t,_,_+n,wdi.JSQuic.bppmask[t.rgb_state.wmidx],i,o,r),wdi.JSQuic.wmimax>t.rgb_state.wmidx&&(t.rgb_state.wmileft-=n))}function uncompress_row0_seg(t,e,i,r,o,_,n){var s,a,c,d=t.channels[0],w=t.channels[1],l=t.channels[2],u=d.correlate_row,f=w.correlate_row,m=l.correlate_row,b=0;for(b=e?e+t.rgb_state.waitcnt:(s=UNCOMPRESS_ONE_ROW0_0(d),a=UNCOMPRESS_ONE_ROW0_0(w),c=UNCOMPRESS_ONE_ROW0_0(l),t.appendPixel(s,a,c),t.rgb_state.waitcnt?--t.rgb_state.waitcnt:(t.rgb_state.waitcnt=wdi.JSQuic.tabrand(t.rgb_state)&r,UPDATE_MODEL(0,t,o,u,f,m)),++e+t.rgb_state.waitcnt);b<i;){for(;e<=b;e++)s=UNCOMPRESS_ONE_ROW0(d,e,_,t,u,s),a=UNCOMPRESS_ONE_ROW0(w,e,_,t,f,a),c=UNCOMPRESS_ONE_ROW0(l,e,_,t,m,c),t.appendPixel(s,a,c);UPDATE_MODEL(b,t,o,u,f,m),b=e+(wdi.JSQuic.tabrand(t.rgb_state)&r)}for(;e<i;e++)s=UNCOMPRESS_ONE_ROW0(d,e,_,t,u,s),a=UNCOMPRESS_ONE_ROW0(w,e,_,t,f,a),c=UNCOMPRESS_ONE_ROW0(l,e,_,t,m,c),t.appendPixel(s,a,c);t.rgb_state.waitcnt=b-i}function UNCOMPRESS_ONE_0(t,e,i,r){var o,_;t.oldFirst=t.correlate_row[0],o=golomb_decoding(find_bucket(t,t.correlate_row[0]).bestcode,e.io_word,wdi.JSQuic.bppmask,wdi.notGRprefixmask,wdi.notGRcwlen,wdi.nGRcodewords,wdi.notGRsuffixlen),t.correlate_row[0]=o[0],_=o[1];var n=wdi.xlatL2U[t.correlate_row[0]]+e.result[r+t.num_channel]&i;return e.eatbits(_,e),n}function UNCOMPRESS_ONE(t,e,i,r,o,_,n,s,a,c,d,w,l){var u,f=(m=golomb_decoding(w[n[i]].bestcode,_.io_word,wdi.JSQuic.bppmask,wdi.notGRprefixmask,wdi.notGRcwlen,wdi.nGRcodewords,wdi.notGRsuffixlen))[0];u=m[1];var m=d[n[e]=f]+(l+a[s+r+c]>>>1)&o;return _.eatbits(u,_),m}function UNCOMPRESS_ONE_ROW0_0(t){var e,i=t.encoder;r=golomb_decoding(find_bucket(t,0).bestcode,i.io_word,wdi.JSQuic.bppmask,wdi.notGRprefixmask,wdi.notGRcwlen,wdi.nGRcodewords,wdi.notGRsuffixlen),t.correlate_row[0]=r[0],e=r[1];var r=wdi.xlatL2U[t.correlate_row[0]];return i.eatbits(e,i),r}function UNCOMPRESS_ONE_ROW0(t,e,i,r,o,_){var n;s=golomb_decoding(find_bucket(t,o[e-1]).bestcode,r.io_word,wdi.JSQuic.bppmask,wdi.notGRprefixmask,wdi.notGRcwlen,wdi.nGRcodewords,wdi.notGRsuffixlen),o[e]=s[0],n=s[1];var s=CORELATE_0(r,t,e,i,o,_);return r.eatbits(n,r),s}function CORELATE_0(t,e,i,r,o,_){return wdi.xlatL2U[o[i]]+_&r}function PIXEL_A(t){return t.result[t.cnt-4]}function PIXEL_B(t,e,i,r){return e.result[r+4*i+t.num_channel]}window=this,window.wdi||(window.wdi={}),window.wdi.WorkerOperations={quic:0,lz_rgb:1,bytesToUriJpeg:2,bytesToUriPng:3},window.workerDispatch=dispatch,self.addEventListener("message",function(t){return dispatch(t.data,!0)},!1),wdi.QuicImageType={QUIC_IMAGE_TYPE_INVALID:0,QUIC_IMAGE_TYPE_GRAY:1,QUIC_IMAGE_TYPE_RGB16:2,QUIC_IMAGE_TYPE_RGB24:3,QUIC_IMAGE_TYPE_RGB32:4,QUIC_IMAGE_TYPE_RGBA:5},wdi.quic={},wdi.JSQuic={QUIC_MAGIC:1364543811,MAXNUMCODES:8,DEFevol:3,MINevol:0,MAXevol:5,DEFwmistart:0,MINwmistart:0,DEFmaxclen:26,DEFwmimax:6,DEFwminext:2048,MINwminext:1,MAXwminext:1e8,MAX_CHANNELS:4,wmimax:6,wminext:2048,evol:3,family_8bpc:new wdi_quic_QuicFamily,family_5bpc:new wdi_quic_QuicFamily,bppmask:new Int32Array([0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215,33554431,67108863,134217727,268435455,536870911,1073741823,2147483647,4294967295]),bitat:new Int32Array([1,2,4,8,16,32,64,128,256,512,1024,2048,4096,8192,16384,32768,65536,131072,262144,524288,1048576,2097152,4194304,8388608,16777216,33554432,67108864,134217728,268435456,536870912,1073741824,2147483648]),TABRAND_TABSIZE:256,TABRAND_SEEDMASK:255,tabrand_chaos:new Int32Array([46495042,893548311,794435923,2453991765,2077388039,894197842,1462934312,697534094,1826128012,343623392,2581292719,3811265708,459739748,2638427270,1654964626,101227083,2654850628,3668700691,572794346,2758751005,3445133904,2344099199,3367450297,898927923,3618406352,1606297603,754696453,20823118,2050458127,972590750,3990194068,3305596553,4239238564,1690498157,3015324227,2306127097,1510321853,548392192,971157512,2292288069,1611390505,4086766286,4084927083,1883326811,1891043243,113180603,1107690783,3778825955,3248980775,2443839100,2190866218,1932072870,495393613,1078522166,4051963518,1784694977,1768732442,2146763203,264646923,1474361405,2361552500,296035746,2489922759,2094565616,2409465348,1334241083,72483606,3740181004,4057920662,1734898312,4114662834,574624900,880305546,3258472262,26713132,1571648456,52557195,4043234286,2458021343,676064371,1528437109,64953873,546717185,2709319979,1947039598,2812723004,28691684,286829174,4235176970,3465707163,12526951,2154766700,3165032534,2036061161,3386656087,2301212354,2023576300,1061142336,3105452904,2743866805,3283373992,3397596080,3085489552,3196092395,3210707808,3651022684,925444321,2088074316,230011220,3223248386,533229176,523863486,3028311159,13140218,2538347282,900399636,3000796173,1526771255,3541282854,2992674461,2135722105,389334227,1225164337,3119947809,1803959919,3471171263,704170491,1407019136,1924534819,526887421,168782227,333811993,298623278,4268451686,381087740,2542899140,3266880867,2498950977,200969370,3511909096,3252303004,2268881098,2499828613,2606499854,3163208665,3790254546,1840025712,1319758833,3771674836,519421307,3512796222,1563402978,4284300462,2263719815,715250337,3178437172,2660191010,2982332026,3256309961,2709659997,3434092872,2367065591,69438718,915160508,183164069,3134331940,175242981,2680543346,1421955782,4231173251,1736652874,3990568476,1710820912,2286604440,3464587098,1261907837,1757387321,1128554270,1090050251,2429922486,1288729218,882830086,211637042,1376462063,2147615815,1737974929,798170275,4271572277,4241687072,1638524620,2760366295,1065115089,2097227717,1224023317,1625204849,3383303351,1488272307,2640186157,1649047732,819719707,2615091943,502645401,760628135,4108137983,63606742,1404337880,1865161130,4272996852,1239761976,790984678,3213322601,1917062825,4195069880,1962259360,2111002573,2311983960,1861406170,511141875,2797510619,1331661048,3130608186,147483493,3767089176,2650841450,4096523407,2574446300,1956416337,851468126,3607527519,1811658703,3642821136,832691095,2453312857,933732854,94341217,3393797730,1695907457,2405722077,2877685663,2469507058,2249636341,3988608661,4001245617,825934927,3103985967,1127151177,3691656896,1640967098,2168932645,2830550957,3998822878,3002602893,1509651465,775813869,2599574079,3791574229]),besttrigtab:[[550,900,800,700,500,350,300,200,180,180,160],[110,550,900,800,550,400,350,250,140,160,140],[100,120,550,900,700,500,400,300,220,250,160]],lzeroes:new Int32Array([8,7,6,6,5,5,5,5,4,4,4,4,4,4,4,4,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),J:new Int32Array([0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,5,5,6,6,7,7,8,9,10,11,12,13,14,15]),zeroLUT:null,BPC_MASK:{4:255,5:255,24:255,16:31},stabrand:function(){return this.TABRAND_SEEDMASK},tabrand:function(t){return t.tabrand_seed++,this.tabrand_chaos[t.tabrand_seed&this.TABRAND_SEEDMASK]},set_wm_trigger:function(t){var e=t.wmidx;10<e&&(e=10),t.wm_trigger=wdi.JSQuic.besttrigtab[Math.floor(wdi.JSQuic.evol>>1)][e]},ceil_log_2:function(t){var e;if(1===t)return 0;for(t-=e=1;t>>>=1;)e++;return e},decorelate_init:function(t,e){var i,r=this.bppmask[e],o=r>>>1;for(i=0;i<=r;i++)t.xlatU2L[i]=i<=o?i<<1>>>0:1+(r-i<<1>>>0)},corelate_init:function(t,e){var i,r=this.bppmask[e];for(i=0;i<=r;i++)t.xlatL2U[i]=1&i?r-(i>>>1):i>>>1},family_init:function(t,e,i){var r;for(r=0;r<e;r++){var o,_;(o=i-e)>parseInt(this.bppmask[e-r])&&(o=this.bppmask[e-r]),_=this.bppmask[e]+1-(o<<r>>>0),t.nGRcodewords[r]=o<<r>>>0,t.notGRcwlen[r]=o+this.ceil_log_2(_),t.notGRprefixmask[r]=this.bppmask[32-o],t.notGRsuffixlen[r]=this.ceil_log_2(_)}this.corelate_init(t,e)},init_zeroLUT:function(){var t,e,i,r;for(this.zeroLUT=new Int32Array(256),e=i=1,r=8,t=0;t<256;++t)this.zeroLUT[t]=r,0===--i&&(i=e,--r,e*=2)},quic_init:function(){this.family_init(this.family_8bpc,8,this.DEFmaxclen),this.init_zeroLUT(),wdi.xlatL2U=new Int32Array(this.family_8bpc.xlatL2U.length),wdi.xlatL2U.set(this.family_8bpc.xlatL2U),wdi.notGRprefixmask=new Int32Array(this.family_8bpc.notGRprefixmask.length),wdi.notGRprefixmask.set(this.family_8bpc.notGRprefixmask),wdi.nGRcodewords=new Int32Array(this.family_8bpc.nGRcodewords.length),wdi.nGRcodewords.set(this.family_8bpc.nGRcodewords),wdi.notGRcwlen=new Int32Array(this.family_8bpc.notGRcwlen.length),wdi.notGRcwlen.set(this.family_8bpc.notGRcwlen),wdi.notGRsuffixlen=new Int32Array(this.family_8bpc.notGRsuffixlen.length),wdi.notGRsuffixlen.set(this.family_8bpc.notGRsuffixlen);for(var t=wdi.JSQuic.lzeroes,e=new Int32Array(t),i=t.length,r=0;r<i;r++)e[r]=t[r]+8;wdi.JSQuic.lzeroes8=e;var o=new Int32Array(t);for(r=0;r<i;r++)o[r]=t[r]+16;wdi.JSQuic.lzeroes16=o;var _=new Int32Array(t);for(r=0;r<i;r++)_[r]=t[r]+24;wdi.JSQuic.lzeroes24=_},quic_image_params:function(t,e){var i,r;switch(e){case wdi.QuicImageType.QUIC_IMAGE_TYPE_GRAY:i=1,r=8;break;case wdi.QuicImageType.QUIC_IMAGE_TYPE_RGB16:i=3,r=5;break;case wdi.QuicImageType.QUIC_IMAGE_TYPE_RGB24:case wdi.QuicImageType.QUIC_IMAGE_TYPE_RGB32:i=3,r=8;break;case wdi.QuicImageType.QUIC_IMAGE_TYPE_RGBA:i=4,r=8;break;case wdi.QuicImageType.QUIC_IMAGE_TYPE_INVALID:default:r=i=0}return[i,r]},find_model_params:function(t,e){var i=0,r=0,o=0,_=0,n={ncounters:8};switch(n.levels=1<<e,n.n_buckets_ptrs=0,this.evol){case 1:n.repfirst=3,n.firstsize=1,n.repnext=2,n.mulsize=2;break;case 3:n.repfirst=1,n.firstsize=1,n.repnext=1,n.mulsize=2;break;case 5:n.repfirst=1,n.firstsize=1,n.repnext=1,n.mulsize=4;break;case 0:case 2:case 4:default:return wdi.Debug.error("fund model params: invalid evol"),!1}for(n.nbuckets=0,_=n.repfirst+1,i=n.firstsize;r=n.nbuckets?o+1:0,--_||(_=n.repnext,i*=n.mulsize),(o=r+i-1)+i>=n.levels&&(o=n.levels-1),n.n_buckets_ptrs||(n.n_buckets_ptrs=n.levels),n.nbuckets++,o<n.levels-1;);return n},init_model_structures:function(t,e,i){e.buckets_buf=[];for(var r=0;r<i.nbuckets;r++)e.buckets_buf[r]=new wdi_quic_s_bucket;e.buckets_ptrs=[],e.counters=[],this.fill_model_structures(t,e,i)},fill_model_structures:function(t,e,i){var r,o,_,n,s=0;n=0,_=i.repfirst+1,r=i.firstsize;do{o=n?s+1:0,--_||(_=i.repnext,r*=i.mulsize),(s=o+r-1)+r>=i.levels&&(s=i.levels-1),e.buckets_buf[n].pcounters=new Int32Array(i.ncounters);for(var a=0;a<i.ncounters;a++)e.buckets_buf[n].pcounters[a]=0;for(var c=o;c<=s;c++)e.buckets_ptrs[c]=e.buckets_buf[n];n++}while(s<i.levels-1)},initChannel:function(t,e){e.encoder=t,e.state.encoder=t,e.correlate_row_width=0,e.correlate_row=null;var i=this.find_model_params(t,8);t.n_buckets_8bpc=i.nbuckets,this.init_model_structures(t,e.family_stat_8bpc,i),i=this.find_model_params(t,5),t.n_buckets_5bpc=i.nbuckets,this.init_model_structures(t,e.family_stat_5bpc,i)},encoder_reste_channels:function(t,e,i,r){t.num_channels=e;for(var o=0;o<e;o++){var _,n;if(t.channels[o].correlate_row_width<i&&(t.channels[o].correlate_row=new Array(i),t.channels[o].correlate_row_width=i),t.channels[o].num_channel=o,8===r){_=t.channels[o].family_stat_8bpc.buckets_buf,n=t.n_buckets_8bpc;for(var s=0;s<n;s++)_[s].bestcode=7;t.channels[o]._buckets_ptrs=t.channels[o].family_stat_8bpc.buckets_ptrs}else{if(5!==r)return FALSE;_=t.channels[o].family_stat_5bpc.buckets_buf,n=t.n_buckets_5bpc;for(s=0;s<n;s++)_[s].bestcode=4;t.channels[o]._buckets_ptrs=t.channels[o].family_stat_5bpc.buckets_ptrs}t.channels[o].state.waitcnt=0,t.channels[o].state.tabrand_seed=wdi.JSQuic.stabrand(),t.channels[o].state.wmidx=wdi.JSQuic.DEFwmistart,t.channels[o].state.wmileft=wdi.JSQuic.wminext}return!0},decode_channel_run:function(t,e){for(var i=0;;){var r,o;for(r=wdi.JSQuic.zeroLUT[(~(t.io_word>>>24)>>>0)%256],o=1;o<=r;o++)i+=e.state.melcorder,e.state.melcstate<32&&(e.state.melclen=wdi.JSQuic.J[++e.state.melcstate],e.state.melcorder=1<<e.state.melclen>>>0);if(8!==r){t.eatbits(r+1,t);break}t.eatbits(8,t)}return e.state.melclen&&(i+=t.io_word>>>32-e.state.melclen,t.eatbits(e.state.melclen,t)),e.state.melcstate&&(e.state.melclen=wdi.JSQuic.J[--e.state.melcstate],e.state.melcorder=1<<e.state.melclen>>>0),i},decode_run:function(t){for(var e,i,r,o=0,_=wdi.JSQuic.zeroLUT,n=t.rgb_state,s=wdi.JSQuic.J,a=t.eatbits;;){for(r=(e=_[(~(t.io_word>>>24)>>>0)%256])+1,i=1;i<r;i++)o+=t.rgb_state.melcorder,n.melcstate<32&&(n.melclen=s[++n.melcstate],n.melcorder=1<<n.melclen>>>0);if(8!==e){a(r,t);break}t.eatbits(8,t)}return n.melclen&&(o+=t.io_word>>>32-n.melclen,a(n.melclen,t)),n.melcstate&&(n.melclen=s[--n.melcstate],n.melcorder=1<<n.melclen>>>0),o},quic_decode:function(t){var e=new wdi_quic_Encoder(new Uint32Array(t)),i=65280&e.io_word;e.io_word;e.eat32bits(),e.eat32bits();e.io_word;e.eat32bits();e.io_word;e.eat32bits();var r=e.io_word;e.eat32bits(),e.type=r;var o=e.io_word;e.width=o,e.eat32bits();var _=e.io_word;e.height=_,e.eat32bits();var n=wdi.JSQuic.quic_image_params(e,r),s=n[0],a=n[1];this.encoder_reste_channels(e,s,o,a);var c=new ArrayBuffer(o*_*4),d=new Uint8Array(c);t=new Uint32Array(c);switch(e.result=d,e.resultData=t,e.setComputedWidth(o),r){case wdi.QuicImageType.QUIC_IMAGE_TYPE_RGB32:case wdi.QuicImageType.QUIC_IMAGE_TYPE_RGB24:QUIC_UNCOMPRESS_RGB(e,s,a,r);break;case wdi.QuicImageType.QUIC_IMAGE_TYPE_RGB16:break;case wdi.QuicImageType.QUIC_IMAGE_TYPE_RGBA:if(QUIC_UNCOMPRESS_RGBA(e,s,a,r),i)for(var w=d.length-1;0<w;)d[w]=255,w-=4}return c}},wdi.JSQuic.quic_init(),wdi_quic_Encoder.prototype.append=function(t){this.result[this.cnt++]=t},wdi_quic_Encoder.prototype.appendPixel=function(t,e,i){this.resultData[this.pxCnt++]=255<<24|i<<16|e<<8|t,this.cnt+=4},wdi_quic_Encoder.prototype.eatbits=function(t,e){var i=e.io_available_bits,r=e.io_word,o=i-t;if(r<<=t,0<=o)return r=(r|e.io_next_word>>>o)>>>0,e.io_available_bits=o,void(e.io_word=r);var _=e.io_next_word;r=((r|=_<<(o=-o)>>>0)|(_=e.usr[e.io_now++])>>>(i=32-o))>>>0,e.io_available_bits=i,e.io_word=r,e.io_next_word=_},wdi_quic_Encoder.prototype.eat32bits=function(){this.eatbits(16,this),this.eatbits(16,this)},wdi_quic_Encoder.prototype.read_io_word=function(){this.io_next_word=this.usr[this.io_now++]},wdi_quic_Encoder.prototype.row_completed=function(){this.rows_completed++},wdi_quic_Encoder.prototype.setComputedWidth=function(t){this.computedWidth=4*t},wdi_quic_Encoder.prototype.appendAlpha=function(t){this.result[this.alphaPos]=t,this.alphaPos+=4};var lzDecompress={LZ_IMAGE_TYPE_INVALID:0,LZ_IMAGE_TYPE_PLT1_LE:1,LZ_IMAGE_TYPE_PLT1_BE:2,LZ_IMAGE_TYPE_PLT4_LE:3,LZ_IMAGE_TYPE_PLT4_BE:4,LZ_IMAGE_TYPE_PLT8:5,LZ_IMAGE_TYPE_RGB16:6,LZ_IMAGE_TYPE_RGB24:7,LZ_IMAGE_TYPE_RGB32:8,LZ_IMAGE_TYPE_RGBA:9,LZ_IMAGE_TYPE_XXXA:10,LZPALETTE_FLAG_PAL_CACHE_ME:1,LZPALETTE_FLAG_PAL_FROM_CACHE:2,LZPALETTE_FLAG_TOP_DOWN:4,PLT_PIXELS_PER_BYTE:[0,8,8,2,2,1],PLT1_MASK:[1,2,4,8,16,32,64,128],lz_rgb32_decompress_rgb_opaque_reverse:function(t){for(var e,i,r,o,_,n,s,a=new Uint8Array(t),c=(a[2],256*a[5]+a[4]),d=65536*(256*a[7]+a[6])+c,w=new ArrayBuffer(d),l=new Uint32Array(w),u=new DataView(t),f=u.getUint32(8),m=u.getUint32(12),b=d/4-1,p=a[16],h=16;0<=b;)if(0!=(p=a[h++])&&0!=(d=p>>5)){if(i=b,r=(31&p)<<8,7==d)for(;d+=e=a[h++],255==e;);if(0==(r+=a[h++])){for(o=l[i+1];9<d;)l[b]=o,l[b-1]=o,l[b-2]=o,l[b-3]=o,l[b-4]=o,l[b-5]=o,l[b-6]=o,l[b-7]=o,l[b-8]=o,l[b-9]=o,b-=10,d-=10;for(;0!=d--;)l[b--]=o}else{for(8191==r&&(r+=(a[h]<<8)+a[h+1],h+=2),i+=r+1;9<d;)l[b]=l[i],l[b-1]=l[i-1],l[b-2]=l[i-2],l[b-3]=l[i-3],l[b-4]=l[i-4],l[b-5]=l[i-5],l[b-6]=l[i-6],l[b-7]=l[i-7],l[b-8]=l[i-8],l[b-9]=l[i-9],b-=10,d-=10,i-=10;for(;0!=d--;)l[b--]=l[i--]}}else{for(;9<p;)l[b]=4278190080|a[h]<<16|a[h+1]<<8|a[h+2],l[b-1]=4278190080|a[h+3]<<16|a[h+4]<<8|a[h+5],l[b-2]=4278190080|a[h+6]<<16|a[h+7]<<8|a[h+8],l[b-3]=4278190080|a[h+9]<<16|a[h+10]<<8|a[h+11],l[b-4]=4278190080|a[h+12]<<16|a[h+13]<<8|a[h+14],l[b-5]=4278190080|a[h+15]<<16|a[h+16]<<8|a[h+17],l[b-6]=4278190080|a[h+18]<<16|a[h+19]<<8|a[h+20],l[b-7]=4278190080|a[h+21]<<16|a[h+22]<<8|a[h+23],l[b-8]=4278190080|a[h+24]<<16|a[h+25]<<8|a[h+26],l[b-9]=4278190080|a[h+27]<<16|a[h+28]<<8|a[h+29],h+=30,b-=10,p-=10;0!=p&&(9==p?(l[b]=4278190080|a[h]<<16|a[h+1]<<8|a[h+2],l[b-1]=4278190080|a[h+3]<<16|a[h+4]<<8|a[h+5],l[b-2]=4278190080|a[h+6]<<16|a[h+7]<<8|a[h+8],l[b-3]=4278190080|a[h+9]<<16|a[h+10]<<8|a[h+11],l[b-4]=4278190080|a[h+12]<<16|a[h+13]<<8|a[h+14],l[b-5]=4278190080|a[h+15]<<16|a[h+16]<<8|a[h+17],l[b-6]=4278190080|a[h+18]<<16|a[h+19]<<8|a[h+20],l[b-7]=4278190080|a[h+21]<<16|a[h+22]<<8|a[h+23],l[b-8]=4278190080|a[h+24]<<16|a[h+25]<<8|a[h+26],h+=27,b-=9):8==p?(l[b]=4278190080|a[h]<<16|a[h+1]<<8|a[h+2],l[b-1]=4278190080|a[h+3]<<16|a[h+4]<<8|a[h+5],l[b-2]=4278190080|a[h+6]<<16|a[h+7]<<8|a[h+8],l[b-3]=4278190080|a[h+9]<<16|a[h+10]<<8|a[h+11],l[b-4]=4278190080|a[h+12]<<16|a[h+13]<<8|a[h+14],l[b-5]=4278190080|a[h+15]<<16|a[h+16]<<8|a[h+17],l[b-6]=4278190080|a[h+18]<<16|a[h+19]<<8|a[h+20],l[b-7]=4278190080|a[h+21]<<16|a[h+22]<<8|a[h+23],h+=24,b-=8):7==p?(l[b]=4278190080|a[h]<<16|a[h+1]<<8|a[h+2],l[b-1]=4278190080|a[h+3]<<16|a[h+4]<<8|a[h+5],l[b-2]=4278190080|a[h+6]<<16|a[h+7]<<8|a[h+8],l[b-3]=4278190080|a[h+9]<<16|a[h+10]<<8|a[h+11],l[b-4]=4278190080|a[h+12]<<16|a[h+13]<<8|a[h+14],l[b-5]=4278190080|a[h+15]<<16|a[h+16]<<8|a[h+17],l[b-6]=4278190080|a[h+18]<<16|a[h+19]<<8|a[h+20],h+=21,b-=7):6==p?(l[b]=4278190080|a[h]<<16|a[h+1]<<8|a[h+2],l[b-1]=4278190080|a[h+3]<<16|a[h+4]<<8|a[h+5],l[b-2]=4278190080|a[h+6]<<16|a[h+7]<<8|a[h+8],l[b-3]=4278190080|a[h+9]<<16|a[h+10]<<8|a[h+11],l[b-4]=4278190080|a[h+12]<<16|a[h+13]<<8|a[h+14],l[b-5]=4278190080|a[h+15]<<16|a[h+16]<<8|a[h+17],h+=18,b-=6):5==p?(l[b]=4278190080|a[h]<<16|a[h+1]<<8|a[h+2],l[b-1]=4278190080|a[h+3]<<16|a[h+4]<<8|a[h+5],l[b-2]=4278190080|a[h+6]<<16|a[h+7]<<8|a[h+8],l[b-3]=4278190080|a[h+9]<<16|a[h+10]<<8|a[h+11],l[b-4]=4278190080|a[h+12]<<16|a[h+13]<<8|a[h+14],h+=15,b-=5):4==p?(l[b]=4278190080|a[h]<<16|a[h+1]<<8|a[h+2],l[b-1]=4278190080|a[h+3]<<16|a[h+4]<<8|a[h+5],l[b-2]=4278190080|a[h+6]<<16|a[h+7]<<8|a[h+8],l[b-3]=4278190080|a[h+9]<<16|a[h+10]<<8|a[h+11],h+=12,b-=4):3==p?(l[b]=4278190080|a[h]<<16|a[h+1]<<8|a[h+2],l[b-1]=4278190080|a[h+3]<<16|a[h+4]<<8|a[h+5],l[b-2]=4278190080|a[h+6]<<16|a[h+7]<<8|a[h+8],h+=9,b-=3):2==p?(l[b]=4278190080|a[h]<<16|a[h+1]<<8|a[h+2],l[b-1]=4278190080|a[h+3]<<16|a[h+4]<<8|a[h+5],h+=6,b-=2):1==p&&(l[b--]=4278190080|a[h]<<16|a[h+1]<<8|a[h+2],h+=3)),l[b--]=4278190080|a[h]<<16|a[h+1]<<8|a[h+2],h+=3}for(var E=f-1;m--;)for(s=new Uint32Array(w,m*f*4,f),_=0,n=E;_<n;){var S=s[_];s[_++]=s[n],s[n--]=S}return w},lz_rgb32_decompress_rgb:function(t){var e=0,i=new Uint8Array(t),r=i[1],o=i[2],_=i[3];if(r&&!_)return lzDecompress.lz_rgb32_decompress_rgb_opaque_reverse(t);for(var n,s,a,c,d,w,l,u=256*i[5]+i[4],f=65536*(256*i[7]+i[6])+u,m=new ArrayBuffer(f),b=new Uint32Array(m),p=f/4,h=i[16],E=16;e!=p;)if(0!=(h=i[E++])&&0!=(f=h>>5)){if(s=e,a=(31&h)<<8,7==f)for(;f+=n=i[E++],255==n;);if(0==(a+=i[E++])){for(w=b[--s];9<f;)b[e]=w,b[e+1]=w,b[e+2]=w,b[e+3]=w,b[e+4]=w,b[e+5]=w,b[e+6]=w,b[e+7]=w,b[e+8]=w,b[e+9]=w,e+=10,f-=10;for(;0!=f--;)b[e++]=w}else if(8191==a&&(a+=(i[E]<<8)+i[E+1],E+=2),s-=a+1,100<f&&s+f<e)l=new Uint32Array(m,4*s,f),b.set(l,e),e+=f,s+=f;else{for(;9<f;)b[e]=b[s],b[e+1]=b[s+1],b[e+2]=b[s+2],b[e+3]=b[s+3],b[e+4]=b[s+4],b[e+5]=b[s+5],b[e+6]=b[s+6],b[e+7]=b[s+7],b[e+8]=b[s+8],b[e+9]=b[s+9],e+=10,f-=10,s+=10;for(;0!=f--;)b[e++]=b[s++]}}else{for(;9<h;)b[e]=4278190080|i[E]<<16|i[E+1]<<8|i[E+2],b[e+1]=4278190080|i[E+3]<<16|i[E+4]<<8|i[E+5],b[e+2]=4278190080|i[E+6]<<16|i[E+7]<<8|i[E+8],b[e+3]=4278190080|i[E+9]<<16|i[E+10]<<8|i[E+11],b[e+4]=4278190080|i[E+12]<<16|i[E+13]<<8|i[E+14],b[e+5]=4278190080|i[E+15]<<16|i[E+16]<<8|i[E+17],b[e+6]=4278190080|i[E+18]<<16|i[E+19]<<8|i[E+20],b[e+7]=4278190080|i[E+21]<<16|i[E+22]<<8|i[E+23],b[e+8]=4278190080|i[E+24]<<16|i[E+25]<<8|i[E+26],b[e+9]=4278190080|i[E+27]<<16|i[E+28]<<8|i[E+29],E+=30,e+=10,h-=10;0!=h&&(9==h?(b[e]=4278190080|i[E]<<16|i[E+1]<<8|i[E+2],b[e+1]=4278190080|i[E+3]<<16|i[E+4]<<8|i[E+5],b[e+2]=4278190080|i[E+6]<<16|i[E+7]<<8|i[E+8],b[e+3]=4278190080|i[E+9]<<16|i[E+10]<<8|i[E+11],b[e+4]=4278190080|i[E+12]<<16|i[E+13]<<8|i[E+14],b[e+5]=4278190080|i[E+15]<<16|i[E+16]<<8|i[E+17],b[e+6]=4278190080|i[E+18]<<16|i[E+19]<<8|i[E+20],b[e+7]=4278190080|i[E+21]<<16|i[E+22]<<8|i[E+23],b[e+8]=4278190080|i[E+24]<<16|i[E+25]<<8|i[E+26],E+=27,e+=9):8==h?(b[e]=4278190080|i[E]<<16|i[E+1]<<8|i[E+2],b[e+1]=4278190080|i[E+3]<<16|i[E+4]<<8|i[E+5],b[e+2]=4278190080|i[E+6]<<16|i[E+7]<<8|i[E+8],b[e+3]=4278190080|i[E+9]<<16|i[E+10]<<8|i[E+11],b[e+4]=4278190080|i[E+12]<<16|i[E+13]<<8|i[E+14],b[e+5]=4278190080|i[E+15]<<16|i[E+16]<<8|i[E+17],b[e+6]=4278190080|i[E+18]<<16|i[E+19]<<8|i[E+20],b[e+7]=4278190080|i[E+21]<<16|i[E+22]<<8|i[E+23],E+=24,e+=8):7==h?(b[e]=4278190080|i[E]<<16|i[E+1]<<8|i[E+2],b[e+1]=4278190080|i[E+3]<<16|i[E+4]<<8|i[E+5],b[e+2]=4278190080|i[E+6]<<16|i[E+7]<<8|i[E+8],b[e+3]=4278190080|i[E+9]<<16|i[E+10]<<8|i[E+11],b[e+4]=4278190080|i[E+12]<<16|i[E+13]<<8|i[E+14],b[e+5]=4278190080|i[E+15]<<16|i[E+16]<<8|i[E+17],b[e+6]=4278190080|i[E+18]<<16|i[E+19]<<8|i[E+20],E+=21,e+=7):6==h?(b[e]=4278190080|i[E]<<16|i[E+1]<<8|i[E+2],b[e+1]=4278190080|i[E+3]<<16|i[E+4]<<8|i[E+5],b[e+2]=4278190080|i[E+6]<<16|i[E+7]<<8|i[E+8],b[e+3]=4278190080|i[E+9]<<16|i[E+10]<<8|i[E+11],b[e+4]=4278190080|i[E+12]<<16|i[E+13]<<8|i[E+14],b[e+5]=4278190080|i[E+15]<<16|i[E+16]<<8|i[E+17],E+=18,e+=6):5==h?(b[e]=4278190080|i[E]<<16|i[E+1]<<8|i[E+2],b[e+1]=4278190080|i[E+3]<<16|i[E+4]<<8|i[E+5],b[e+2]=4278190080|i[E+6]<<16|i[E+7]<<8|i[E+8],b[e+3]=4278190080|i[E+9]<<16|i[E+10]<<8|i[E+11],b[e+4]=4278190080|i[E+12]<<16|i[E+13]<<8|i[E+14],E+=15,e+=5):4==h?(b[e]=4278190080|i[E]<<16|i[E+1]<<8|i[E+2],b[e+1]=4278190080|i[E+3]<<16|i[E+4]<<8|i[E+5],b[e+2]=4278190080|i[E+6]<<16|i[E+7]<<8|i[E+8],b[e+3]=4278190080|i[E+9]<<16|i[E+10]<<8|i[E+11],E+=12,e+=4):3==h?(b[e]=4278190080|i[E]<<16|i[E+1]<<8|i[E+2],b[e+1]=4278190080|i[E+3]<<16|i[E+4]<<8|i[E+5],b[e+2]=4278190080|i[E+6]<<16|i[E+7]<<8|i[E+8],E+=9,e+=3):2==h?(b[e]=4278190080|i[E]<<16|i[E+1]<<8|i[E+2],b[e+1]=4278190080|i[E+3]<<16|i[E+4]<<8|i[E+5],E+=6,e+=2):1==h&&(b[e++]=4278190080|i[E]<<16|i[E+1]<<8|i[E+2],E+=3)),b[e++]=4278190080|i[E]<<16|i[E+1]<<8|i[E+2],E+=3}if(o===this.LZ_IMAGE_TYPE_RGBA&&!r){var S=new Uint8Array(m);for(e=0,h=null,h=i[E++];e<p;h=i[E++])if(f=h>>5,a=(31&h)<<8,d=4*(s=e),32<=h){if(6===--f)for(;f+=n=i[E++],255===n;);if(a+=n=i[E++],255===n&&a-n==7936&&(a=i[E++]<<8,a+=i[E++],a+=8191),f+=3,(s-=a+=1)===e-1)for(c=s;f;--f)S[(d=4*e)+3]=S[4*c+3],e++;else for(;f;--f)S[(d=4*e)+3]=S[4*s+3],e++,s++}else for(h++,S[d+3]=i[E++],e++,--h;h;h--)S[(d=4*e)+3]=i[E++],e++}return m}};wdi.LZSS?wdi.LZSS.lz_rgb32_decompress_rgb=lzDecompress.lz_rgb32_decompress_rgb:wdi.LZSS=lzDecompress;